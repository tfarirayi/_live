<!--
Main application container element
@tfarirayi1
-->
<!-- Dependencies -->
<!-- Polymer dependency -->
<link rel="import" href="../bower_components/polymer/polymer.html">
<!-- App elements -->
<link rel="import" href="../bower_components/app-route/app-route.html">
<link rel="import" href="../bower_components/app-route/app-location.html">
<link rel="import" href="../bower_components/app-layout/app-header/app-header.html">
<link rel="import" href="../bower_components/app-layout/app-header-layout/app-header-layout.html">
<link rel="import" href="../bower_components/app-layout/app-toolbar/app-toolbar.html">
<link rel="import" href="../bower_components/app-layout/app-scroll-effects/app-scroll-effects.html">
<!-- Iron elements -->
<link rel="import" href="../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../bower_components/iron-image/iron-image.html">
<!-- Neon elements -->
<link rel="import" href="../bower_components/neon-animation/neon-animation-runner-behavior.html">
<link rel="import" href="../bower_components/neon-animation/animations/fade-in-animation.html">
<link rel="import" href="../bower_components/neon-animation/animations/fade-out-animation.html">
<!-- Paper elements -->
<link rel="import" href="../bower_components/paper-styles/shadow.html">
<link rel="import" href="../bower_components/paper-progress/paper-progress.html">
<!-- Google fonts -->
<link href='//fonts.googleapis.com/css?family=Arvo|Space+Mono|Raleway|Oswald|Roboto|Source+Code+Pro' rel='stylesheet'>
<!-- Custom elements -->
<link rel="import" href="my-icons.html">
<link rel="import" href="my-styles.html">

<dom-module id="my-app">
<template>
    <style include="my-styles">
        :host {
            @apply(--layout-fullbleed);
            @apply(--layout-vertical);
        }

        app-header-layout {
            @apply(--layout-fullbleed);
        }

        app-header {
            background-color: rgba(207,216,220 ,0.9);
            border-radius: 0px 0px 8px 8px;
            border: 1px outset rgba(255,138,101 ,0.7);   
            border-top: none;                      
            color: rgba(55,71,79 ,1);
            height: 124px;
            @apply(--shadow-elevation-4dp);
        }
       
        app-toolbar.top-bar {
            color: rgba(38,50,56 ,1);
            height: 64px;
            text-shadow: 1px 1px rgba(255,138,101 ,0.8);
            @apply(--layout-horizontal);
            @apply(--layout-end);
            @apply(--layout-center-justified);
        }

        app-toolbar.bottom-bar {
            height: 58px;
            @apply(--layout-horizontal);
            @apply(--layout-center);
            @apply(--layout-center-justified);
        }

        paper-button.home-button, a {
            color: inherit;
            font-family: 'Space Mono', monospace;
            font-size: 18px;
            padding: 0px;
            text-align: center;
            text-decoration: none;
            text-transform: none;
        }

        paper-button.home-button {
            @apply(--layout-vertical);  
        }
        
        paper-button.home-button:focus, a:focus {
            font-weight: normal;
            text-decoration: none;
        }

        .main-title {
            line-height: 120%;
        }

        paper-progress.slow {
             width: 100%;
             margin: auto;
             position: fixed;
             top: 0;
             left: 0;
             right: 0;
             --paper-progress-indeterminate-cycle-duration: 4s;
             --paper-progress-container-color: rgba(207,216,220 ,0.9);
             --paper-progress-height: 1px;
             --paper-progress-active-color: rgba(255,138,101 ,0.7);
        }

        iron-pages {
            padding-bottom: 56px;
        }

        paper-progress.slow[loaded] {
            display: none;
        }

        a.home-link {
            outline: none;
        }

        iron-icon {
            padding: 3px;
        }

        iron-icon[selected] {
            background-color: rgba(255,138,101 ,0.4);
            text-shadow: 1px 1px rgba(255,138,101 ,0.8);
            padding: 3px;
            border-radius: 50%;
        }
    </style>
    <!-- Local dom here -->
        <!-- Routing -->
        <app-location route="{{route}}"></app-location>
        <app-route
            route="{{route}}"
            pattern="/:page"
            data="{{routeData}}"
            tail="{{tail}}">
        </app-route>

            <!-- Header Layout Container -->
            <app-header-layout effects="blend-background" fullbleed>
                <app-header id="header" condenses fixed>
                <!-- Toolbar Top -->
                <paper-progress id="progress" class="slow" indeterminate></paper-progress>
                <app-toolbar class="top-bar">
                    <div class="bottom main-title">
                        <a href="/home" tabindex="-1" class="home-link">
                            <!--<paper-button class="home-button" noink><span class="logo">Orange House</span><span class="logo">Web Academy </span></paper-button>-->
                            <iron-image src="../images/logo.png" style="width: 120px; height: 26px;" sizing="contain"></iron-image>
                        </a>
                    </div>
                </app-toolbar>
                <!-- Toolbar Bottom -->
                <app-toolbar class="bottom-bar" sticky>
                    <a href="/info" class="top-icon">
                        <iron-icon id="infoIcon" icon="my-icons:info-outline"></iron-icon>
                    </a>
                    <a href="/phone" class="top-icon">
                        <iron-icon id="phoneIcon" icon="my-icons:phone-iphone"></iron-icon>
                    </a>
                    <a href="/message" class="top-icon">
                        <iron-icon id="messageIcon" icon="my-icons:mail"></iron-icon>
                    </a>
                </app-toolbar>
                </app-header>

                    <!-- Routing Display -->
                    <iron-pages id="content"
                        attr-for-selected="id" 
                        fallback-selection="home" 
                        selected="[[page]]">

                        <home-page 
                            id="home"></home-page>

                        <ebooking-page 
                            id="ebooking"></ebooking-page>

                        <efolio-page 
                            id="efolio"></efolio-page>

                        <message-page 
                            id="message"></message-page>

                        <phone-page 
                            id="phone"></phone-page>
                        
                        <info-page 
                            id="info"></info-page>
                        
                    </iron-pages>

            </app-header-layout>

</template>
    <script>
        Polymer ({
            is: 'my-app',

            properties: {

                page: {
                    type: String,
                    reflectToAttribute: true,
                    observer: '_pageChanged'
                },

                year: {
                    type: String,
                    value: function() {
                        var date = new Date();
                        return date.getFullYear();
                    }
                }
            },

            observers: [
                '_routePageChanged(routeData.page)'
            ],

            created: function() {
                Polymer.RenderStatus.afterNextRender(this, function() {
                    // this.importHref(this.resolveUrl('lazy-resources.html'), null, null, true);
                });
            },

            _pageChanged: function(page) {
                // Show footer when page load successful (1)
                var main = this;
                                        this.$.messageIcon.removeAttribute('selected');
                        this.$.infoIcon.removeAttribute('selected');
                        this.$.phoneIcon.removeAttribute('selected');
                if (page == 'message' || page == 'info' || page == 'phone') {
                    if (page == 'message') {
                        this.$.messageIcon.setAttribute('selected', '');

                    } else if (page == 'info') {
                        this.$.infoIcon.setAttribute('selected', '');

                    } else if (page == 'phone') {
                        this.$.phoneIcon.setAttribute('selected', '');
                        
                    } else {

                    }

                } else {

                    
                }

                switch(page) {
                    case 'message': 
                        this.$.messageIcon.setAttribute('selected', '');
                        break;
                    case 'info': 
                        this.$.infoIcon.setAttribute('selected', '');
                        break;
                    case 'phone': 
                        this.$.phoneIcon.setAttribute('selected', '');
                        break;
                    default:
                        this.$.messageIcon.removeAttribute('selected');
                        this.$.infoIcon.removeAttribute('selected');
                        this.$.phoneIcon.removeAttribute('selected');
                }
                
                main.$.header.scroll({top: 0});
                main.$.progress.removeAttribute('loaded');
                var resolvedPageUrl = this.resolveUrl(page + '-page.html');
                this.importHref(resolvedPageUrl, function() {
                    main.$.progress.setAttribute('loaded', '');
                    return;
                }, this._show404, true);
            },

            _routePageChanged: function(page) {
                // Set to home page if page is undefined
                this.page = page || 'home';

            },

            _show404: function() {
                this.page = 'home';
            }

        });
    </script>
</dom-module>
